"use strict";var vm=new Vue({el:"#app",components:{},data:{id:"",goodsList1:[],show:!0,selected:[],corpId:""},computed:{},watch:{},filters:{},methods:{getGoodsList:function(t){var e=this,o=getApiUrl("/shop-test/rest/ddproducts/dingding/list");$.ajax({type:"GET",url:o,xhrFields:{withCredentails:!0},crossDomain:!0,data:{categoryId:1},success:function(t){e.goodsList1=t.data}})},toUserCenter:function(){location.href="userCenter.html"},toGoodsDetail:function(t){location.href="goodsDetail.html?productId="+t},getAuthCode:function(){var t=this;dd.ready(function(){dd.runtime.permission.requestAuthCode({corpId:t.corpId,onSuccess:function(e){t.getUserId(e.code)},onFail:function(t){}})})},getUserId:function(t){var e=this,o=getApiUrl("/ding-isv-access/get_user_info");$.ajax({url:o,type:"GET",dataType:"json",data:{url:window.location.href,corpId:this.corpId,code:t},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){e.getUserDetail(t.userId)},error:function(t){ddToast("网络错误")}})},getUserDetail:function(t){var e=this,o=getApiUrl("/ding-isv-access/get_user_detail");$.ajax({url:o,type:"GET",dataType:"json",data:{corpId:this.corpId,useId:t},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){var o={corpId:e.corpId,userId:t.userid,companyName:t.companyName,avatar:t.avatar,name:t.name};setSession(o),e.setUserDetail(t)},error:function(t){ddToast("网络错误")}})},setUserDetail:function(t){var e={userid:t.userid,unionid:t.unionid,nailCropId:this.corpId,name:t.name,isAdmin:t.isAdmin,isBoss:t.isBoss,dingId:t.dingId,companyName:t.companyName},o=getApiUrl("/shop-test/rest/user/addInformation");$.ajax({url:o,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(e),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){},error:function(t){ddToast("网络错误")}})}},created:function(){},destroyed:function(){},mounted:function(){this.corpId=getUrlParam("corpId"),this.getGoodsList(),this.getAuthCode(),dd.ready(function(){dd.biz.navigation.setRight({show:!0,control:!1,text:"更多",onSuccess:function(t){dd.biz.util.share({type:0,url:window.location.href,title:"淘租公公公",content:"淘租公钉钉微应用",image:"asset/images/icon/logo.png",onSuccess:function(){},onFail:function(t){}})},onFail:function(t){}})})}});