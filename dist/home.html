<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>淘租公</title>
  <link rel="stylesheet" type="text/css" href="asset/css/reset-8a6bf83bb8.css" />
  <link rel="stylesheet" type="text/css" href="asset/css/home-288826e9ce.css" />
  <link rel="stylesheet" href="https://unpkg.com/mint-ui/lib/style.css">
  <style>
    [v-cloak]{
      display: none;
    }
  </style>
</head>
<body>
      <div id="app" v-cloak>
          <div class="yamanTupian">
             <!-- <img src="asset/images/icon/homeTitleGoods.png" class="homeImg1"> -->
          </div>
          <div class="newModal">
             <div class="newTop">
                <span class="newTitle ">淘租公</span>
                <span  class="newTitle te">
                  <img class="newImg" src="asset/images/icon/xiaoxi.png">
                </span>
              </div>
            <a href="javascript:void(0)" class="newContent">
              <marquee direction='left'>Dyson又出新产品了，历史价格最低...</marquee>
            </a>
          </div>
          <div class="homeBox">
              <div class="homeMain"
                v-for="(item, index) in goodsList1" :key="index">
                  <div class="homeMain-top" >
                    <div class="homeMain-title">{{item.category}}</div>
                    <img src="asset/images/icon/more.png" class="newImg1" v-if='item.productVo.length > 0'>
                  </div>
                  <div class="homeAround-top" >
                      <div  class="homeAround">
                        <div class="homeAroundLeft" v-for="goods in item.productVo" style="float:left;margin-left:0;margin-bottom:0.3rem;">
                            <a @click="toGoodsDetail(goods.productEntity.id)">
	                              <img v-lazy="goods.productEntity.cover" class="newImg2" >
	                              <div class="homeName">{{goods.productEntity.name}}</div>
	                              <div class="homeDecc">{{goods.productEntity.brief}}</div>
	                              <div class="homeTitle"><span class="jine">金额</span> ￥<em class="homeMoney">{{goods.list[0].toFixed(2)}}</em></div>
	                          </a>

                        </div>
                      </div>
                    </div>
                </div>
          </div>
          <div class="footer">
            <mt-tabbar fixed="true">
              <a style="width:50%">
                <mt-tab-item id="tab4" style="color:#F3654C">
                  <img slot="icon" src="asset/images/icon/lease_in.png">
                  租赁
                </mt-tab-item>
              </a>
              <a @click="toUserCenter()" style="width:50%">
                <mt-tab-item id="tab3" >
                  <img slot="icon" src="asset/images/icon/user_center_out.png" @click="toUserCenter()">
                  我的
                </mt-tab-item>
              </a>
            </mt-tabbar>
        </div>
    </div>
</body>
<script src="https://g.alicdn.com/dingding/open-develop/1.9.0/dingtalk.js"></script>
<script src="static/js/zepto.min.js"></script>
<script src="static/js/polyfill.js"></script>
<script src="asset/js/util-a17ea04659.js"></script>
<script src="static/js/vue.min.js"></script>
<script src="https://unpkg.com/mint-ui/lib/index.js"></script>
<script src="asset/js/home-10de9a0730.js"></script>
<script>
  // alert(3)
  // var corpId = getUrlParam('corpId')
  // var user = getSession()
  // alert(user)
  if (!user || !user.userId || !user.name|| !user.companyName) {
    alert(1)
    getAuthCode()
  }
  
  function getAuthCode() {
    alert(4)
      var url = getApiUrl('/ding-isv-access/get_js_config');
      $.ajax({
        url: url,
        type: "GET",
        dataType: "json",
        data: {
          url: window.location.href,
          corpId: corpId
        },
        // xhrFields: {
        //   withCredentials: true
        // },
        // crossDomain: true,
        success: function(config) {
          alert(JSON.stringify(res))

          // dd.config({
          //     agentId: config.agentId, // 必填，微应用ID
          //     corpId: config.corpId,//必填，企业ID
          //     timeStamp: config.timeStamp, // 必填，生成签名的时间戳
          //     nonceStr: config.nonce, // 必填，生成签名的随机串
          //     signature: config.signature, // 必填，签名
          //     jsApiList: ['ui.pullToRefresh.enable','ui.pullToRefresh.stop','biz.util.openLink','biz.navigation.setLeft','biz.navigation.setTitle','biz.navigation.setRight'] // 必填，需要使用的jsapi列表
          // });
          // ddConfig(res)
          // dd.ready(() => {
            //获取免登授权码
            // dd.runtime.permission.requestAuthCode({
            //   corpId: corpId,
            //   onSuccess: function(result) {
            //     alert('requestAuthCode:' + JSON.stringify(result))
            //     // getUserId(result.code)
            //   },
            //   onFail:function(err) {
            //     alert("fail" + JSON.stringify(err))
            //   }
            // })
          // });
        },
        error: function(e) {
          ddToast('网络错误')
        }
      })
    }
  // function getUserId(code) {
  //   let url = getApiUrl('/ding-isv-access/get_user_info');
  //   $.ajax({
  //     url: url,
  //     type: "GET",
  //     dataType: "json",
  //     data: {
  //       url: window.location.href,
  //       corpId: corpId,
  //       code: code
  //     },
  //     xhrFields: {
  //       withCredentials: true
  //     },
  //     crossDomain: true,
  //     success: function(result) {
  //       getUserDetail(result.userId)
  //     },
  //     error: function(e) {
  //       ddToast('网络错误')
  //     }
  //   })
  // }
  // function getUserDetail(userId) {
  //   // this.corpId = 'dingaaa4a95c02214e0835c2f4657eb6378f'
  //   // userId = '141502201726340017'
  //   let url = getApiUrl('/ding-isv-access/get_user_detail');
  //   $.ajax({
  //     url: url,
  //     type: "GET",
  //     dataType: "json",
  //     data: {
  //       corpId: corpId,
  //       useId: userId
  //     },
  //     xhrFields: {
  //       withCredentials: true
  //     },
  //     crossDomain: true,
  //     success: function(result) {
  //       var sessionObj = {
  //         corpId: corpId,
  //         userId: result.userid,
  //         companyName: result.companyName,
  //         avatar: result.avatar,
  //         name: result.name
  //       }
  //       //  session存储对象
  //       setSession(sessionObj)
  //       setUserDetail(result)
  //     },
  //     error:function(e) {
  //       ddToast('网络错误')
  //     }
  //   })
  // }
  // function setUserDetail(user) {
  //   let userDetail = {
  //     userid: user.userid,
  //     unionid: user.unionid,
  //     nailCropId: corpId,
  //     name: user.name,
  //     isAdmin: user.isAdmin,
  //     isBoss: user.isBoss,
  //     dingId: user.dingId,
  //     companyName: user.companyName
  //   }
  //   let url = getApiUrl('/shop-test/rest/user/addInformation');
  //   $.ajax({
  //     url: url,
  //     type: "POST",
  //     dataType: "json",
  //     contentType: "application/json",
  //     data: JSON.stringify(userDetail),
  //     xhrFields: {
  //       withCredentials: true
  //     },
  //     crossDomain: true,
  //     success: function(result) {
  //     },
  //     error: function(e) {
  //       ddToast('网络错误')
  //     }
  //   })
  // }

  
</script>
</html>
