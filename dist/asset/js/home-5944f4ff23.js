"use strict";var vm=new Vue({el:"#app",components:{},data:{id:"",goodsList1:[],show:!0,selected:[],corpId:""},computed:{},watch:{},filters:{},methods:{getGoodsList:function(e){var t=this,s=getApiUrl("/shop-test/rest/ddproducts/dingding/list");$.ajax({type:"GET",url:s,xhrFields:{withCredentails:!0},crossDomain:!0,data:{categoryId:1},success:function(e){t.goodsList1=e.data}})},toUserCenter:function(){location.href="userCenter.html"},toGoodsDetail:function(e){location.href="goodsDetail.html?productId="+e},getAuthCode:function(){var e=this,t=getApiUrl("/ding-isv-access/get_js_config");$.ajax({url:t,type:"GET",dataType:"json",data:{url:window.location.href,corpId:this.corpId},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){alert(3),ddConfig(t),alert(7),dd.ready(function(){alert(4),dd.runtime.permission.requestAuthCode({corpId:e.corpId,onSuccess:function(t){alert("requestAuthCode:"+JSON.stringify(t)),e.getUserId(t.code)},onFail:function(e){alert("fail"+JSON.stringify(e))}})})},error:function(e){alert("error:"+JSON.stringify(e))}})},getUserId:function(e){var t=this,s=getApiUrl("/ding-isv-access/get_user_info");$.ajax({url:s,type:"GET",dataType:"json",data:{url:window.location.href,corpId:this.corpId,code:e},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){alert("userIdSuccess:"+JSON.stringify(e)),t.getUserDetail(e.userId)},error:function(e){ddToast("网络错误")}})},getUserDetail:function(e){var t=this,s=getApiUrl("/ding-isv-access/get_user_detail");$.ajax({url:s,type:"GET",dataType:"json",data:{corpId:this.corpId,useId:e},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){alert("getUserDetail:"+JSON.stringify(e));var s={corpId:t.corpId,userId:e.userid,companyName:e.companyName,avatar:e.avatar,name:e.name};setSession(s),t.setUserDetail(e)},error:function(e){ddToast("网络错误")}})},setUserDetail:function(e){var t={userid:e.userid,unionid:e.unionid,nailCropId:this.corpId,name:e.name,isAdmin:e.isAdmin,isBoss:e.isBoss,dingId:e.dingId,companyName:e.companyName},s=getApiUrl("/shop-test/rest/user/addInformation");$.ajax({url:s,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(t),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){alert("setUserDetail")},error:function(e){ddToast("网络错误")}})}},created:function(){},destroyed:function(){},mounted:function(){this.corpId=getUrlParam("corpId"),this.getGoodsList(),alert(2),window.localStorage.clear(),getSession()&&getSession().userId||(alert(1),this.getAuthCode())}});