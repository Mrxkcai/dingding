"use strict";var vm=new Vue({el:"#app",components:{},props:{},data:{authId:3,productId:"",userAuth:{company:"不匠",companyDelegateImg:"asset/images/icon/proof.png",dingIndexImg:"asset/images/icon/proof.png",idcard:"321322199602052213",name:"周磊",registerNo:"330104000287730",status:0,rejectReason:"的v"},isFirstAuth:!0,canEdit:!0,validate:["company","idcard","name","registerNo"],authStatus:{success:1,fail:2,audit:0},authHead:{icon:"",title:"",describe:[]},showPop:!1,popTitle:"客服电话",setStyle:"textAlign:center;fontSize:.38rem;lineHeight:2",popContent:["0571-85180735"]},computed:{},watch:{},filters:{},methods:{onFileChange:function(t,e){var a=this,s="/getapi/img/upload.do";uploadImg(t,s).then(function(t){0===e?a.userAuth.dingIndexImg=t:1===e&&(a.userAuth.companyDelegateImg=t)})["catch"](function(t){ddToast("图片上传失败")})},closeImg:function(t){0===t?this.userAuth.dingIndexImg="asset/images/icon/proof.png":1===t&&(this.userAuth.companyDelegateImg="asset/images/icon/proof.png")},authValidate:function(){var t=this,e=!0;return this.validate.some(function(a){if(!t.userAuth[a])return e="请填写必填项",!0}),e?e:("asset/images/icon/proof.png"==this.userAuth.dingIndexImg||"asset/images/icon/proof.png"==this.userAuth.companyDelegateImg?e="请上传凭证":checkIdcard(this.userAuth.idcard)||(e="身份证号输入有误"),e)},saveUserAuth:function(){var t=this.authValidate();if(1!=t)return void ddToast(t);var e="/getapi/rest/dingDingUserInfo/Ddcreate";$.ajax({url:e,type:"POST",data:JSON.stringify(this.userAuth),contentType:"application/json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){200==t.code?ddToast("授权成功"):ddToast(t.message)},error:function(t){ddToast("网络错误")}})},getUserAuth:function(){var t=this,e=getApiUrl("/rest/dingDingUserInfo/Ddlist");$.ajax({url:e,type:"POST",dataType:"json",data:{id:this.authId},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(e){200==e.code&&(t.userAuth=e.data,t.userAuth.status=t.authStatus.fail,t.userAuth.status===t.authStatus.fail?(t.canEdit=!0,t.authHead.icon="asset/images/icon/auth_fail.png",t.authHead.title="审核拒绝",t.authHead.describe[0]=t.userAuth.rejectReason,t.authHead.describe[1]="请重新编辑授权信息，再次提交审核"):t.userAuth.status===t.authStatus.success?(t.authHead.icon="asset/images/icon/auth_success.png",t.authHead.title="审核通过",t.authHead.describe[0]="恭喜你，授权信息已经审核通过；可以前往订单列表页完成支付"):t.userAuth.status===t.authStatus.audit&&(t.authHead.icon="asset/images/icon/auth_audit.png",t.authHead.title="审核中",t.authHead.describe[0]="你的授权信息正在审核中，请耐心等待"))},error:function(t){ddToast("网络错误")}})},updateUserAuth:function(){var t=this.authValidate();if(1!=t)return void ddToast(t);var e=getApiUrl("/rest/dingDingUserInfo/Ddupdate");this.userAuth.id=this.authId,$.ajax({url:e,type:"POST",data:JSON.stringify(this.userAuth),contentType:"application/json",xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){200==t.code?ddToast("修改成功"):ddToast(t.message)},error:function(t){ddToast("网络错误")}})},zhimaAuth:function(){var t=getApiUrl("/nail/zhimaauth.html");$.ajax({url:t,type:"POST",dataType:"json",data:{name:this.userAuth.name,card:this.userAuth.idcard,productId:this.productId},xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){200==t.code?location.href=t.data.url:ddToast(t.message)},error:function(t){ddToast("网络错误")}})}},created:function(){},destroyed:function(){},mounted:function(){this.productId=getUrlParam("productId"),this.authId=getUrlParam("authId"),getUrlParam("authId")?(this.authId=getUrlParam("authId"),this.canEdit=!1,this.isFirstAuth=!1,this.getUserAuth()):(this.isFirstAuth=!0,this.canEdit=!0)}});